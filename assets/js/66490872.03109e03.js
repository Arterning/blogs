"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[3775],{8015:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>h});var a=n(757);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var c=a.createContext({}),i=function(e){var t=a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},d=function(e){var t=i(e.components);return a.createElement(c.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,l=e.originalType,c=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),p=i(n),m=o,h=p["".concat(c,".").concat(m)]||p[m]||u[m]||l;return n?a.createElement(h,r(r({ref:t},d),{},{components:n})):a.createElement(h,r({ref:t},d))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var l=n.length,r=new Array(l);r[0]=m;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s[p]="string"==typeof e?e:o,r[1]=s;for(var i=2;i<l;i++)r[i]=n[i];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8685:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>u,frontMatter:()=>l,metadata:()=>s,toc:()=>i});var a=n(1227),o=(n(757),n(8015));const l={},r=void 0,s={unversionedId:"notes/\u6280\u672f\u6808/Next/\u5e38\u7528Hooks\u8be6\u89e3\u53ca\u5b9e\u8df5",id:"notes/\u6280\u672f\u6808/Next/\u5e38\u7528Hooks\u8be6\u89e3\u53ca\u5b9e\u8df5",title:"\u5e38\u7528Hooks\u8be6\u89e3\u53ca\u5b9e\u8df5",description:"\u51c6\u5907",source:"@site/docs/notes/\u6280\u672f\u6808/Next/4-\u5e38\u7528Hooks\u8be6\u89e3\u53ca\u5b9e\u8df5.md",sourceDirName:"notes/\u6280\u672f\u6808/Next",slug:"/notes/\u6280\u672f\u6808/Next/\u5e38\u7528Hooks\u8be6\u89e3\u53ca\u5b9e\u8df5",permalink:"/blogs/docs/notes/\u6280\u672f\u6808/Next/\u5e38\u7528Hooks\u8be6\u89e3\u53ca\u5b9e\u8df5",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/notes/\u6280\u672f\u6808/Next/4-\u5e38\u7528Hooks\u8be6\u89e3\u53ca\u5b9e\u8df5.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{},sidebar:"notes",previous:{title:"TailWindCSS\u7684\u4f7f\u7528\u8be6\u89e3",permalink:"/blogs/docs/notes/\u6280\u672f\u6808/Next/TailWindCSS\u7684\u4f7f\u7528\u8be6\u89e3"},next:{title:"Next auth",permalink:"/blogs/docs/notes/\u6280\u672f\u6808/Next/Next auth"}},c={},i=[{value:"\u51c6\u5907",id:"\u51c6\u5907",level:2},{value:"<code>useState</code>",id:"usestate",level:2},{value:"<code>useEffect</code>",id:"useeffect",level:2},{value:"\u7b80\u5355\u7528\u6cd5",id:"\u7b80\u5355\u7528\u6cd5",level:3},{value:"\u4f9d\u8d56\u66f4\u65b0",id:"\u4f9d\u8d56\u66f4\u65b0",level:3},{value:"\u6e05\u7406\u76d1\u542c",id:"\u6e05\u7406\u76d1\u542c",level:3},{value:"\u5f02\u6b65\u6267\u884c",id:"\u5f02\u6b65\u6267\u884c",level:3},{value:"<code>useContext</code>",id:"usecontext",level:2},{value:"\u5b9a\u4e49\u7c7b\u578b",id:"\u5b9a\u4e49\u7c7b\u578b",level:3},{value:"\u5b9a\u4e49\u8bed\u8a00\u5217\u8868",id:"\u5b9a\u4e49\u8bed\u8a00\u5217\u8868",level:3},{value:"\u521b\u5efa<code>context</code>",id:"\u521b\u5efacontext",level:3},{value:"\u521b\u5efa<code>provider</code>\u5305\u88c5\u5668",id:"\u521b\u5efaprovider\u5305\u88c5\u5668",level:3},{value:"\u521b\u5efa<code>Lang</code>\u7ec4\u4ef6",id:"\u521b\u5efalang\u7ec4\u4ef6",level:3},{value:"<code>App.tsx</code>\u5305\u88c5",id:"apptsx\u5305\u88c5",level:3},{value:"\u8bed\u8a00\u9009\u62e9\u7ec4\u4ef6",id:"\u8bed\u8a00\u9009\u62e9\u7ec4\u4ef6",level:3},{value:"Demo\u7ec4\u4ef6",id:"demo\u7ec4\u4ef6",level:3},{value:"<code>useReducer</code>",id:"usereducer",level:2},{value:"\u7f16\u5199\u7c7b\u578b",id:"\u7f16\u5199\u7c7b\u578b",level:3},{value:"\u9ed8\u8ba4\u914d\u7f6e",id:"\u9ed8\u8ba4\u914d\u7f6e",level:3},{value:"\u521b\u5efa<code>Context</code>",id:"\u521b\u5efacontext-1",level:3},{value:"\u72b6\u6001\u64cd\u4f5c",id:"\u72b6\u6001\u64cd\u4f5c",level:3},{value:"\u5305\u88c5\u5668\u7ec4\u4ef6",id:"\u5305\u88c5\u5668\u7ec4\u4ef6",level:3},{value:"\u4e3b\u9898\u9009\u62e9\u7ec4\u4ef6",id:"\u4e3b\u9898\u9009\u62e9\u7ec4\u4ef6",level:3},{value:"Demo\u7ec4\u4ef6",id:"demo\u7ec4\u4ef6-1",level:3},{value:"\u5728<code>App.tsx</code>\u4e2d\u5305\u88c5",id:"\u5728apptsx\u4e2d\u5305\u88c5",level:3},{value:"\u66f4\u6539\u5e03\u5c40\u7ec4\u4ef6",id:"\u66f4\u6539\u5e03\u5c40\u7ec4\u4ef6",level:3}],d={toc:i},p="wrapper";function u(e){let{components:t,...n}=e;return(0,o.kt)(p,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"\u51c6\u5907"},"\u51c6\u5907"),(0,o.kt)("p",null,"\u5173\u4e8ereact\u7684\u57fa\u7840\u77e5\u8bc6\uff0c\u6bd4\u5982jsx\u7b49\u7b49\u5176\u65b0\u5b98\u7f51\u5df2\u7ecf\u8bf4\u7684\u975e\u5e38\u660e\u786e\uff0c\u6307\u76f4\u63a5\u67e5\u770b",(0,o.kt)("a",{parentName:"p",href:"https://zh-hans.reactjs.org/learn/describing-the-ui"},"\u5b98\u7f51\u4e2d\u6587\u6587\u6863"),"\u5373\u53ef\uff0c\u672c\u6559\u6750\u4e0d\u518d\u8d58\u8ff0\uff0c\u6211\u4eec\u76f4\u63a5\u5f00\u59cb\u5b66\u4e60hooks\u7684\u7075\u6d3b\u4f7f\u7528\n\u4f9d\u8d56"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"~ pnpm add clsx immer lodash\n~ pnpm add @types/lodash -D\n")),(0,o.kt)("h2",{id:"usestate"},(0,o.kt)("inlineCode",{parentName:"h2"},"useState")),(0,o.kt)("p",null,"\u6b64Hook\u7528\u4e8e\u6539\u53d8\u7ec4\u4ef6\u5185\u7684\u72b6\u6001,\u4f8b"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},'export const StateDemo: FC = () => {\n    const [count, setCount] = useState(1);\n    const [isShow, toggleShow] = useState(true);\n\n    return (\n        <div className={clsx($styles.container, \'tw-w-[20rem]\')}>\n            <h2 className="tw-text-center">useState Demo</h2>\n            {isShow && <p className="tw-text-center tw-py-5">{count}</p>}\n            <div className="tw-flex tw-justify-around">\n                <Button onClick={() => setCount(count + 1)} type="dashed" ghost>\n                    \u589e\u52a0\n                </Button>\n                <Button onClick={() => setCount(count - 1)} type="dashed" ghost>\n                    \u51cf\u5c11\n                </Button>\n                <Button onClick={() => toggleShow(!isShow)} type="dashed" ghost>\n                    {isShow ? \'\u663e\u793a\' : \'\u9690\u85cf\'}\n                </Button>\n            </div>\n        </div>\n    );\n};\n')),(0,o.kt)("h2",{id:"useeffect"},(0,o.kt)("inlineCode",{parentName:"h2"},"useEffect")),(0,o.kt)("p",null,"\u5728\u72b6\u6001\u4e0d\u540c\u7684\u751f\u547d\u5468\u671f\u6267\u884c\u526f\u4f5c\u7528"),(0,o.kt)("h3",{id:"\u7b80\u5355\u7528\u6cd5"},"\u7b80\u5355\u7528\u6cd5"),(0,o.kt)("p",null,"\u6bcf\u6b21\u72b6\u6001\u66f4\u65b0\u90fd\u6267\u884c\u6240\u6709\u6ca1\u6709\u4f9d\u8d56\u7684",(0,o.kt)("inlineCode",{parentName:"p"},"useEffect"),",\u4ee5\u4e0b\u4ee3\u7801'toggle ghost'\u8fd9\u4e00\u6761\u5728",(0,o.kt)("inlineCode",{parentName:"p"},"resize"),"\u6d4f\u89c8\u5668\u65f6\u4e5f\u4f1a\u89e6\u53d1"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"export const EffectDemo: FC = () => {\n    const [ghost, setGhost] = useState<boolean>(false);\n    const [width, setWidth] = useState(window.innerWidth);\n    const toggleGhostBtn = () => setGhost(!ghost);\n    const resizeHandle = () => setWidth(window.innerWidth);\n    useEffect(() => {\n        console.log('\u6d4f\u89c8\u5668\u5bbd\u5ea6\u6539\u53d8');\n        window.addEventListener('resize', resizeHandle);\n    },);\n    useEffect(() => {\n        console.log('\u5207\u6362\u5e7d\u7075\u6309\u94ae');\n    });\n    return (\n        <div className={$styles.container}>\n            <h2 className=\"tw-text-center\">useEffect Demo</h2>\n            <p className=\"tw-text-center tw-py-5\">{ghost ? 'ghost' : '\u666e\u901a'}\u6309\u94ae</p>\n            <Button type=\"primary\" onClick={toggleGhostBtn} ghost={ghost}>\n                \u5207\u6362\u6309\u94ae\u6837\u5f0f\n            </Button>\n            <p className=\"pt-5\">\u5bbd\u5ea6\u4e3a: {width}</p>\n        </div>\n    );\n};\n")),(0,o.kt)("h3",{id:"\u4f9d\u8d56\u66f4\u65b0"},"\u4f9d\u8d56\u66f4\u65b0"),(0,o.kt)("p",null,"\u901a\u8fc7",(0,o.kt)("inlineCode",{parentName:"p"},"useEffect"),"\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570,\u53ef\u4ee5\u6307\u5b9a\u5176\u4f9d\u8d56\u7684\u53d8\u91cf,\u53ea\u6709\u6b64\u53d8\u91cf\u7684\u72b6\u6001\u66f4\u6539\u65f6\u624d\u4f1a\u6267\u884c\u526f\u4f5c\u7528\u51fd\u6570,\u5982\u679c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e3a\u7a7a,\u5219\u53ea\u5728\u7b2c\u4e00\u6b21\u6e32\u67d3\u548c\u91cd\u65b0\u6e32\u67d3\u65f6\u89e6\u53d1"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"const EffectDemo: FC = () => {\n    ...\n    useEffect(() => {\n        console.log('\u6d4f\u89c8\u5668\u5bbd\u5ea6\u6539\u53d8');\n        window.addEventListener('resize', resizeHandle);\n    }, [width]);\n    useEffect(() => {\n        console.log('\u5207\u6362\u5e7d\u7075\u6309\u94ae');\n    }, [ghost]);\n    useEffect(() => {\n        console.log('\u53ea\u5728\u7b2c\u4e00\u6b21\u6216\u91cd\u65b0\u6e32\u67d3\u7ec4\u4ef6\u65f6\u89e6\u53d1');\n    }, []);\n};\n")),(0,o.kt)("h3",{id:"\u6e05\u7406\u76d1\u542c"},"\u6e05\u7406\u76d1\u542c"),(0,o.kt)("p",null,"\u5728\u76d1\u542c",(0,o.kt)("inlineCode",{parentName:"p"},"width"),"\u7684",(0,o.kt)("inlineCode",{parentName:"p"},"useEffect"),"\u4e2d,\u6bcf\u6b21\u6539\u53d8",(0,o.kt)("inlineCode",{parentName:"p"},"width"),"\u7684\u72b6\u6001,\u90fd\u4f1a\u6dfb\u52a0\u4e00\u4e2a",(0,o.kt)("inlineCode",{parentName:"p"},"resize"),"\u4e8b\u4ef6,\u8fd9\u4f1a\u6781\u5927\u7684\u8017\u8d39\u6d4f\u89c8\u5668\u5360\u7528\u7684\u5185\u5b58,\u901a\u8fc7\u4e00\u4e2a\u8fd4\u56de\u503c\u7684\u65b9\u5f0f,\u5373\u53ef\u5728\u4e0b\u4e00\u6b21",(0,o.kt)("inlineCode",{parentName:"p"},"width"),"\u72b6\u6001\u6539\u53d8\u540e\u4e0e\u6dfb\u52a0\u65b0\u7684",(0,o.kt)("inlineCode",{parentName:"p"},"resize"),"\u76d1\u542c\u524d,\u53d6\u6d88\u4e0a\u6b21\u6dfb\u52a0\u7684",(0,o.kt)("inlineCode",{parentName:"p"},"resize"),"\u76d1\u542c\u4e8b\u4ef6"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"const EffectDemo: FC = () => {\n    ...\n    useEffect(() => {\n        window.addEventListener('resize', resizeHandle);\n        return () => {\n            window.removeEventListener('resize', resizeHandle);\n        };\n    }, [width]);\n};\n")),(0,o.kt)("h3",{id:"\u5f02\u6b65\u6267\u884c"},"\u5f02\u6b65\u6267\u884c"),(0,o.kt)("p",null,"\u5728",(0,o.kt)("inlineCode",{parentName:"p"},"useEffect"),"\u4e2d\u6267\u884c\u5f02\u6b65\u51fd\u6570\u7684\u8bed\u6cd5\u5982\u4e0b,\u5176\u5b9e\u5c31\u662f\u5728\u539f\u51fd\u6570\u91cc\u8c03\u7528\u4e00\u4e2a",(0,o.kt)("inlineCode",{parentName:"p"},"async"),"\u6253\u5934\u7684\u7acb\u5373\u51fd\u6570"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"useEffect(() => {\n    (async () => {})();\n});\n")),(0,o.kt)("p",null,"\u4ee5\u4e0b\u793a\u4f8b\u4ee3\u7801\u8ba9\u6309\u94ae\u5728\u53d8\u6210",(0,o.kt)("inlineCode",{parentName:"p"},"ghost"),"\u4e4b\u540e1s\u518d\u53d8\u7ea2\u8272"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},'\nconst EffectDemo: FC = () => {\n    const [red, setRed] = useState<boolean>(false);\n     useEffect(() => {\n        (async () => {\n            await new Promise((resolve, reject) => {\n                setTimeout(() => resolve(true), 1000);\n            });\n            setRed(ghost);\n        })();\n    }, [ghost]);\n    return (\n        <div>\n            <Button type="primary" onClick={toggleGhostBtn} ghost={ghost} danger={red}>\n                \u5207\u6362\u6309\u94ae\u6837\u5f0f\n            </Button>\n        </div>\n    );\n};\n')),(0,o.kt)("h2",{id:"usecontext"},(0,o.kt)("inlineCode",{parentName:"h2"},"useContext")),(0,o.kt)("p",null,"\u7528\u4e8e\u5411\u540e\u4ee3\u7ec4\u4ef6\u900f\u4f20\u4e00\u4e2a\u503c,\u4ee5\u521b\u5efa\u4e00\u4e2a\u8bed\u8a00\u9009\u62e9\u5668\u4e3a\u4f8b"),(0,o.kt)("h3",{id:"\u5b9a\u4e49\u7c7b\u578b"},"\u5b9a\u4e49\u7c7b\u578b"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"type LangType = {\n    name: string;\n    label: string;\n    data: Locale;\n};\ntype LangState = {\n    lang: LangType;\n    setLang: (lang: LangType) => void;\n};\n")),(0,o.kt)("h3",{id:"\u5b9a\u4e49\u8bed\u8a00\u5217\u8868"},"\u5b9a\u4e49\u8bed\u8a00\u5217\u8868"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"export const langs: LangType[] = [\n    {\n        name: 'en_US',\n        label: '\ud83c\uddfa\ud83c\uddf8 english(US)',\n        data: enUS,\n    },\n    {\n        name: 'zh_CN',\n        label: '\ud83c\udde8\ud83c\uddf3 \u7b80\u4f53\u4e2d\u6587',\n        data: zhCN,\n    },\n];\n")),(0,o.kt)("h3",{id:"\u521b\u5efacontext"},"\u521b\u5efa",(0,o.kt)("inlineCode",{parentName:"h3"},"context")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"export const LangContext = createContext<LangState>({\n    lang: langs[0],\n    setLang: (lang: LangType) => {},\n});\n")),(0,o.kt)("h3",{id:"\u521b\u5efaprovider\u5305\u88c5\u5668"},"\u521b\u5efa",(0,o.kt)("inlineCode",{parentName:"h3"},"provider"),"\u5305\u88c5\u5668"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"const LangProvider: FC<LangState & { children?: ReactNode }> = ({ lang, setLang, children }) => {\n    return <LangContext.Provider value={{ lang, setLang }}>{children}</LangContext.Provider>;\n};\n")),(0,o.kt)("h3",{id:"\u521b\u5efalang\u7ec4\u4ef6"},"\u521b\u5efa",(0,o.kt)("inlineCode",{parentName:"h3"},"Lang"),"\u7ec4\u4ef6"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"export const Lang: FC<{ children?: ReactNode }> = ({ children }) => {\n    const [lang, setLang] = useState<LangType>(langs[0]);\n    return (\n        <LangProvider lang={lang} setLang={setLang}>\n            {children}\n        </LangProvider>\n    );\n};\n")),(0,o.kt)("h3",{id:"apptsx\u5305\u88c5"},(0,o.kt)("inlineCode",{parentName:"h3"},"App.tsx"),"\u5305\u88c5"),(0,o.kt)("p",null,"\u628a",(0,o.kt)("inlineCode",{parentName:"p"},"App.tsx"),"\u4e2d\u7684\u6240\u6709\u8282\u70b9\u5305\u542b\u4e8e",(0,o.kt)("inlineCode",{parentName:"p"},"Lang"),"\u7ec4\u4ef6"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"const App: FC = () => {\n    return (\n        <Lang>\n        ...\n          <ContextDemo />\n        </Lang>\n    );\n};\nexport default App;\n")),(0,o.kt)("h3",{id:"\u8bed\u8a00\u9009\u62e9\u7ec4\u4ef6"},"\u8bed\u8a00\u9009\u62e9\u7ec4\u4ef6"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"export const LangConfig: FC = () => {\n    const { lang, setLang } = useContext(LangContext);\n    const changeLang = (value: string) => {\n        const current = langs.find((item) => item.name === value);\n        current && setLang(current);\n    };\n    return (\n        <Select defaultValue={lang.name} style={{ width: 120 }} onChange={changeLang}>\n            {langs.map(({ name, label }) => (\n                <Select.Option key={name} value={name}>\n                    {label}\n                </Select.Option>\n            ))}\n        </Select>\n    );\n")),(0,o.kt)("h3",{id:"demo\u7ec4\u4ef6"},"Demo\u7ec4\u4ef6"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},'const ContextDemo: FC = () => {\n    const { lang } = useContext(LangContext);\n    return (\n        <div className={$styles.container}>\n            <h2 className="tw-text-center">useContext Demo</h2>\n            <p className="tw-text-center tw-py-5">\u5f53\u524d\u8bed\u8a00: {lang.label}</p>\n            <div className="tw-w-full">\n                <h3>Antd\u8bed\u8a00\u5207\u6362\u6d4b\u8bd5</h3>\n                <div className="tw-w-full tw-my-4">\n                    <LangConfig />\n                </div>\n            </div>\n            <Pagination defaultCurrent={0} total={500} />\n        </div>\n    );\n};\nexport default ContextDemo;\n')),(0,o.kt)("p",null,"\u66f4\u6539\u5e03\u5c40\u7ec4\u4ef6"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},'const MasterLayout: FC<{ children?: ReactNode }> = ({ children }) => {\n    const { lang } = useContext(LangContext);\n\n    return (\n        <ConfigProvider\n            locale={lang.data}\n            theme={{\n                ...\n            }}\n        >\n            <StyleProvider hashPriority="high">\n                <div className={$styles.masterLayout}>{children}</div>\n            </StyleProvider>\n        </ConfigProvider>\n    );\n};\n')),(0,o.kt)("h2",{id:"usereducer"},(0,o.kt)("inlineCode",{parentName:"h2"},"useReducer")),(0,o.kt)("p",null,"\u4f7f\u7528",(0,o.kt)("inlineCode",{parentName:"p"},"Context"),"+",(0,o.kt)("inlineCode",{parentName:"p"},"useReducer"),"\u53ef\u4ee5\u5b9e\u73b0\u8f7b\u91cf\u7ea7\u7684\u5168\u5c40\u72b6\u6001\u7ba1\u7406\n\u4ee5\u5b9e\u73b0\u4e00\u4e2a\u7b80\u5355\u7684\u5e94\u7528\u914d\u7f6e\u529f\u80fd\u4e3a\u4f8b(\u5305\u542b\u6807\u9898\u8bbe\u7f6e\u548c\u6697\u9ed1\u6a21\u5f0f\u5207\u6362)"),(0,o.kt)("h3",{id:"\u7f16\u5199\u7c7b\u578b"},"\u7f16\u5199\u7c7b\u578b"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"export enum ThemeMode {\n    LIGHT = 'light',\n    DARK = 'dark',\n}\n\nexport type ThemeState = {\n    mode: `${ThemeMode}`;\n    compact: boolean;\n};\n\nexport enum ThemeActionType {\n    CHANGE_MODE = 'change_mode',\n    CHANGE_COMPACT = 'change_compact',\n}\n\nexport type ThemeAction =\n    | { type: `${ThemeActionType.CHANGE_MODE}`; value: `${ThemeMode}` }\n    | { type: `${ThemeActionType.CHANGE_COMPACT}`; value: boolean };\n\nexport type ThemeContextType = {\n    state: ThemeState;\n    dispatch: Dispatch<ThemeAction>;\n};\n")),(0,o.kt)("h3",{id:"\u9ed8\u8ba4\u914d\u7f6e"},"\u9ed8\u8ba4\u914d\u7f6e"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"export const defaultThemeConfig: ThemeState = {\n    mode: 'light',\n    compact: false,\n};\n\n")),(0,o.kt)("h3",{id:"\u521b\u5efacontext-1"},"\u521b\u5efa",(0,o.kt)("inlineCode",{parentName:"h3"},"Context")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"// \u900f\u4f20\u914d\u7f6e\u72b6\u6001\u4e0edispatch\nexport const ThemeContext = createContext<ThemeContextType | null>(null);\n")),(0,o.kt)("h3",{id:"\u72b6\u6001\u64cd\u4f5c"},"\u72b6\u6001\u64cd\u4f5c"),(0,o.kt)("p",null,"\u4e3a\u4e86\u786e\u4fdd\u6570\u636e\u7684\u552f\u4e00\u6027\u4e0d\u88ab\u6c61\u67d3,\u4f7f\u7528","[immer.js][]","\u64cd\u4f5c\u6570\u636e"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"export const ThemeReducer: Reducer<ThemeState, ThemeAction> = produce((draft, action) => {\n    switch (action.type) {\n        case 'change_mode':\n            draft.mode = action.value;\n            break;\n        case 'change_compact':\n            draft.compact = action.value;\n            break;\n        default:\n            break;\n    }\n});\n")),(0,o.kt)("h3",{id:"\u5305\u88c5\u5668\u7ec4\u4ef6"},"\u5305\u88c5\u5668\u7ec4\u4ef6"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u5408\u5e76\u9ed8\u8ba4\u914d\u7f6e\u548c\u521d\u59cb\u5316\u914d\u7f6e"),(0,o.kt)("li",{parentName:"ul"},"\u628a\u914d\u7f6e\u72b6\u6001\u548c",(0,o.kt)("inlineCode",{parentName:"li"},"dispatch"),"\u4f20\u7ed9",(0,o.kt)("inlineCode",{parentName:"li"},"ThemeContext"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"export const Theme: FC<{ data?: ThemeState; children?: ReactNode }> = ({ data = {}, children }) => {\n    const [state, dispatch] = useReducer(ThemeReducer, data, (initData) => ({\n        ...defaultThemeConfig,\n        ...initData,\n    }));\n    useEffect(() => {\n        if (state.mode === 'dark') {\n            document.documentElement.setAttribute('data-theme', 'tw-dark');\n        } else {\n            document.documentElement.removeAttribute('data-theme');\n        }\n    }, [state.mode]);\n    return <ThemeContext.Provider value={{ state, dispatch }}>{children}</ThemeContext.Provider>;\n};\n")),(0,o.kt)("h3",{id:"\u4e3b\u9898\u9009\u62e9\u7ec4\u4ef6"},"\u4e3b\u9898\u9009\u62e9\u7ec4\u4ef6"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"export const ThemeConfig: FC = () => {\n    const context = useContext(ThemeContext);\n    if (isNil(context)) return null;\n    const { state, dispatch } = context;\n    const toggleMode = () =>\n        dispatch({ type: 'change_mode', value: state.mode === 'light' ? 'dark' : 'light' });\n    const toggleCompact = () => dispatch({ type: 'change_compact', value: !state.compact });\n    return (\n        <>\n            <Switch\n                checkedChildren=\"\ud83c\udf1b\"\n                unCheckedChildren=\"\u2600\ufe0f\"\n                onChange={toggleMode}\n                checked={state.mode === 'dark'}\n                defaultChecked={state.mode === 'dark'}\n            />\n            <Switch\n                checkedChildren=\"\u7d27\u51d1\"\n                unCheckedChildren=\"\u6b63\u5e38\"\n                onChange={toggleCompact}\n                checked={state.compact}\n                defaultChecked={state.compact}\n            />\n        </>\n    );\n};\n")),(0,o.kt)("h3",{id:"demo\u7ec4\u4ef6-1"},"Demo\u7ec4\u4ef6"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"const ReducerDemo: FC = () => {\n    const context = useContext(ThemeContext);\n    if (isNil(context)) return null;\n    const {\n        state: { mode, compact },\n    } = context;\n    return (\n        <div className={$styles.container}>\n            <h2 className=\"tw-text-center\">useReducer Demo</h2>\n            <p>\u4e3b\u9898\u6a21\u5f0f: \u300c{mode === 'dark' ? '\u6697\u9ed1' : '\u660e\u4eae'}\u300d</p>\n            <p>\u662f\u5426\u7d27\u51d1: \u300c{compact ? '\u662f' : '\u5426'}\u300d</p>\n            <div className=\"tw-w-full\">\n                <ThemeConfig />\n            </div>\n        </div>\n    );\n};\n")),(0,o.kt)("h3",{id:"\u5728apptsx\u4e2d\u5305\u88c5"},"\u5728",(0,o.kt)("inlineCode",{parentName:"h3"},"App.tsx"),"\u4e2d\u5305\u88c5"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"\nconst App = () => {\n    return (\n        <Lang>\n            <Theme>\n                <MasterLayout>\n                    ...\n                    <ReducerDemo />\n                </MasterLayout>\n            </Theme>\n        </Lang>\n    );\n};\n")),(0,o.kt)("h3",{id:"\u66f4\u6539\u5e03\u5c40\u7ec4\u4ef6"},"\u66f4\u6539\u5e03\u5c40\u7ec4\u4ef6"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"const MasterLayout: FC<{ children?: ReactNode }> = ({ children }) => {\n    const { lang } = useContext(LangContext);\n    const themeContext = useContext(ThemeContext);\n    const [antdThemes, setAntdThemes] = useState<MappingAlgorithm[]>([theme.defaultAlgorithm]);\n    let themeMode = defaultThemeConfig.mode;\n    let themeCompact = defaultThemeConfig.compact;\n    if (!isNil(themeContext)) {\n        themeMode = themeContext.state.mode;\n        themeCompact = themeContext.state.compact;\n    }\n    useEffect(() => {\n        if (!themeCompact) {\n            setAntdThemes(() =>\n                themeMode === 'dark' ? [theme.darkAlgorithm] : [theme.defaultAlgorithm],\n            );\n        } else {\n            setAntdThemes(() =>\n                themeMode === 'dark'\n                    ? [theme.darkAlgorithm, theme.compactAlgorithm]\n                    : [theme.defaultAlgorithm, theme.compactAlgorithm],\n            );\n        }\n    }, [themeMode, themeCompact]);\n\n    return (\n        <ConfigProvider\n            locale={lang.data}\n            theme={{\n                algorithm: antdThemes,\n                components: {\n                    Layout: {\n                        colorBgBody: '',\n                    },\n                },\n            }}\n        >\n            <StyleProvider hashPriority=\"high\">\n                <div className={$styles.masterLayout}>{children}</div>\n            </StyleProvider>\n        </ConfigProvider>\n    );\n};\n")))}u.isMDXComponent=!0}}]);