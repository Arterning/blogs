"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1213],{8015:(e,r,t)=>{t.d(r,{Zo:()=>c,kt:()=>D});var n=t(757);function a(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function p(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function l(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?p(Object(t),!0).forEach((function(r){a(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function o(e,r){if(null==e)return{};var t,n,a=function(e,r){if(null==e)return{};var t,n,a={},p=Object.keys(e);for(n=0;n<p.length;n++)t=p[n],r.indexOf(t)>=0||(a[t]=e[t]);return a}(e,r);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);for(n=0;n<p.length;n++)t=p[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var s=n.createContext({}),k=function(e){var r=n.useContext(s),t=r;return e&&(t="function"==typeof e?e(r):l(l({},r),e)),t},c=function(e){var r=k(e.components);return n.createElement(s.Provider,{value:r},e.children)},i="mdxType",d={inlineCode:"code",wrapper:function(e){var r=e.children;return n.createElement(n.Fragment,{},r)}},u=n.forwardRef((function(e,r){var t=e.components,a=e.mdxType,p=e.originalType,s=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),i=k(t),u=a,D=i["".concat(s,".").concat(u)]||i[u]||d[u]||p;return t?n.createElement(D,l(l({ref:r},c),{},{components:t})):n.createElement(D,l({ref:r},c))}));function D(e,r){var t=arguments,a=r&&r.mdxType;if("string"==typeof e||a){var p=t.length,l=new Array(p);l[0]=u;var o={};for(var s in r)hasOwnProperty.call(r,s)&&(o[s]=r[s]);o.originalType=e,o[i]="string"==typeof e?e:a,l[1]=o;for(var k=2;k<p;k++)l[k]=t[k];return n.createElement.apply(null,l)}return n.createElement.apply(null,t)}u.displayName="MDXCreateElement"},3377:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>s,contentTitle:()=>l,default:()=>d,frontMatter:()=>p,metadata:()=>o,toc:()=>k});var n=t(1227),a=(t(757),t(8015));const p={},l="\u4ee5\u4e0b\u5185\u5bb9\u6765\u81ea\u548c ChatGPT \u7684\u5bf9\u8bdd",o={unversionedId:"notes/\u6280\u672f\u6808/spark/spark-\u5165\u95e8",id:"notes/\u6280\u672f\u6808/spark/spark-\u5165\u95e8",title:"\u4ee5\u4e0b\u5185\u5bb9\u6765\u81ea\u548c ChatGPT \u7684\u5bf9\u8bdd",description:"\u8fd9\u79cd\u5bf9\u8bdd\u5f0f\u7684\u5b66\u4e60\u975e\u5e38\u80fd\u591f\u89e3\u51b3\u81ea\u5df1\u7684\u7591\u60d1 \u6bd4\u770b\u51e0\u4e2a\u5c0f\u65f6\u7684\u6559\u7a0b\u6548\u7387\u9ad8\u591a\u4e86",source:"@site/docs/notes/\u6280\u672f\u6808/spark/01-spark-\u5165\u95e8.md",sourceDirName:"notes/\u6280\u672f\u6808/spark",slug:"/notes/\u6280\u672f\u6808/spark/spark-\u5165\u95e8",permalink:"/blogs/docs/notes/\u6280\u672f\u6808/spark/spark-\u5165\u95e8",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/notes/\u6280\u672f\u6808/spark/01-spark-\u5165\u95e8.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{},sidebar:"notes",previous:{title:"\u7f16\u8bd1\u5668\u7684\u6838\u5fc3\u9650\u5236",permalink:"/blogs/docs/notes/\u6280\u672f\u6808/rust/\u7f16\u8bd1\u5668\u7684\u6838\u5fc3\u9650\u5236"},next:{title:"spark \u8fd8\u6709\u54ea\u4e9b\u6838\u5fc3\u6982\u5ff5\u9700\u8981\u91cd\u70b9\u638c\u63e1\u7684\uff1f",permalink:"/blogs/docs/notes/\u6280\u672f\u6808/spark/spark-\u6838\u5fc3\u6982\u5ff5"}},s={},k=[],c={toc:k},i="wrapper";function d(e){let{components:r,...t}=e;return(0,a.kt)(i,(0,n.Z)({},c,t,{components:r,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"\u4ee5\u4e0b\u5185\u5bb9\u6765\u81ea\u548c-chatgpt-\u7684\u5bf9\u8bdd"},"\u4ee5\u4e0b\u5185\u5bb9\u6765\u81ea\u548c ChatGPT \u7684\u5bf9\u8bdd"),(0,a.kt)("p",null,"\u8fd9\u79cd\u5bf9\u8bdd\u5f0f\u7684\u5b66\u4e60\u975e\u5e38\u80fd\u591f\u89e3\u51b3\u81ea\u5df1\u7684\u7591\u60d1 \u6bd4\u770b\u51e0\u4e2a\u5c0f\u65f6\u7684\u6559\u7a0b\u6548\u7387\u9ad8\u591a\u4e86"),(0,a.kt)("h1",{id:"\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0b-spark"},"\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0b spark"),(0,a.kt)("p",null,"Apache Spark \u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u5927\u6570\u636e\u5904\u7406\u6846\u67b6\uff0c\u65e8\u5728\u4ee5\u5feb\u901f\u3001\u7b80\u6d01\u7684\u65b9\u5f0f\u5904\u7406\u5927\u91cf\u6570\u636e\u3002\u5b83\u5728 Hadoop MapReduce \u7684\u57fa\u7840\u4e0a\u63d0\u4f9b\u4e86\u66f4\u9ad8\u7ea7\u7684\u62bd\u8c61\u5c42\uff0c\u4f7f\u5f97\u5927\u6570\u636e\u5206\u6790\u66f4\u52a0\u4fbf\u6377\u3002Spark \u4e0d\u4ec5\u652f\u6301\u6279\u5904\u7406\u3001Streaming\u3001SQL \u7b49\u591a\u79cd\u6570\u636e\u5904\u7406\u6a21\u5f0f\uff0c\u8fd8\u63d0\u4f9b\u4e86\u8bb8\u591a\u9ad8\u7ea7 API\uff0c\u5982 MLib\u3001GraphX \u7b49\uff0c\u53ef\u4ee5\u8fdb\u884c\u673a\u5668\u5b66\u4e60\u3001\u56fe\u8ba1\u7b97\u7b49\u590d\u6742\u4efb\u52a1\u3002"),(0,a.kt)("p",null,"\u603b\u7684\u6765\u8bf4\uff0cSpark \u662f\u4e00\u4e2a\u9ad8\u6548\u3001\u6613\u7528\u3001\u529f\u80fd\u4e30\u5bcc\u7684\u5927\u6570\u636e\u5904\u7406\u6846\u67b6\uff0c\u9002\u7528\u4e8e\u5404\u79cd\u5927\u6570\u636e\u5206\u6790\u573a\u666f\u3002"),(0,a.kt)("h1",{id:"\u7ed9\u6211\u4e00\u4e2a\u7b80\u5355\u7684-spark-\u5904\u7406\u5927\u6570\u636e\u7684\u4f8b\u5b50"},"\u7ed9\u6211\u4e00\u4e2a\u7b80\u5355\u7684 spark \u5904\u7406\u5927\u6570\u636e\u7684\u4f8b\u5b50\uff1f"),(0,a.kt)("p",null,"\u4ee5\u4e0b\u662f\u4e00\u4e2a\u7b80\u5355\u7684 Spark \u7a0b\u5e8f\uff0c\u7528\u4e8e\u7edf\u8ba1\u6587\u672c\u6587\u4ef6\u4e2d\u6bcf\u4e2a\u5355\u8bcd\u51fa\u73b0\u7684\u6b21\u6570\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-scala"},'from pyspark import SparkContext\n\n# \u521b\u5efaSparkContext\nsc = SparkContext("local", "word count example")\n\n# \u8bfb\u53d6\u6587\u4ef6\u5e76\u521b\u5efaRDD\ntext_file = sc.textFile("data.txt")\n\n# \u5c06\u6bcf\u4e00\u884c\u62c6\u5206\u4e3a\u5355\u8bcd\nwords = text_file.flatMap(lambda line: line.split(" "))\n\n# \u5bf9\u6bcf\u4e2a\u5355\u8bcd\u8ba1\u6570\u4e3a1\nword_counts = words.countByValue()\n\n# \u8f93\u51fa\u7ed3\u679c\nfor word, count in word_counts.items():\n    print("{}: {}".format(word, count))\n\n')),(0,a.kt)("p",null,"\u8fd9\u4e2a\u7a0b\u5e8f\u7684\u6b65\u9aa4\u5982\u4e0b\uff1a"),(0,a.kt)("p",null,"\u9996\u5148\uff0c\u901a\u8fc7 SparkContext \u521b\u5efa\u4e00\u4e2a Spark \u4e0a\u4e0b\u6587\uff0c\u8fde\u63a5\u5230 Spark \u96c6\u7fa4\u3002"),(0,a.kt)("p",null,"\u7136\u540e\uff0c\u4f7f\u7528 textFile \u8bfb\u53d6\u6587\u4ef6\uff0c\u5e76\u5c06\u5176\u8f6c\u6362\u4e3a\u4e00\u4e2a RDD\u3002"),(0,a.kt)("p",null,"\u63a5\u4e0b\u6765\uff0c\u4f7f\u7528 flatMap \u5c06\u6bcf\u4e00\u884c\u6587\u672c\u62c6\u5206\u4e3a\u5355\u8bcd\u3002"),(0,a.kt)("p",null,"\u7136\u540e\uff0c\u4f7f\u7528 countByValue \u8ba1\u7b97\u6bcf\u4e2a\u5355\u8bcd\u51fa\u73b0\u7684\u6b21\u6570\u3002"),(0,a.kt)("p",null,"\u6700\u540e\uff0c\u901a\u8fc7\u904d\u5386\u7ed3\u679c\uff0c\u8f93\u51fa\u6bcf\u4e2a\u5355\u8bcd\u51fa\u73b0\u7684\u6b21\u6570\u3002"),(0,a.kt)("p",null,"\u8fd9\u53ea\u662f Spark \u5904\u7406\u5927\u6570\u636e\u7684\u4e00\u4e2a\u7b80\u5355\u4f8b\u5b50\uff0c\u4f60\u53ef\u4ee5\u5728\u6b64\u57fa\u7840\u4e0a\u8fdb\u884c\u66f4\u591a\u590d\u6742\u7684\u5206\u6790\u3002"),(0,a.kt)("h1",{id:"rdd-\u662f\u4ec0\u4e48"},"RDD \u662f\u4ec0\u4e48\uff1f"),(0,a.kt)("p",null,"RDD\uff08Resilient Distributed Datasets\uff09\u662f Spark \u7684\u6838\u5fc3\u62bd\u8c61\uff0c\u8868\u793a\u4e00\u4e2a\u4e0d\u53ef\u53d8\u7684\u3001\u5206\u5e03\u5f0f\u7684\u6570\u636e\u96c6\u3002RDD \u53ef\u4ee5\u901a\u8fc7\u5e76\u884c\u8ba1\u7b97\u5728\u591a\u4e2a\u8282\u70b9\u4e0a\u5904\u7406\u5927\u91cf\u6570\u636e\uff0c\u63d0\u4f9b\u9ad8\u6548\u7684\u6570\u636e\u5904\u7406\u80fd\u529b\u3002"),(0,a.kt)("p",null,"RDD \u7684\u4e3b\u8981\u7279\u70b9\u5982\u4e0b\uff1a"),(0,a.kt)("p",null,"\u5206\u5e03\u5f0f\uff1aRDD \u6570\u636e\u53ef\u4ee5\u5206\u5e03\u5728\u591a\u4e2a\u8282\u70b9\u4e0a\uff0c\u4ee5\u652f\u6301\u5927\u6570\u636e\u5904\u7406\u3002"),(0,a.kt)("p",null,"\u4e0d\u53ef\u53d8\u6027\uff1aRDD \u6570\u636e\u4e0d\u53ef\u53d8\uff0c\u4e00\u65e6\u521b\u5efa\u4e0d\u80fd\u4fee\u6539\u3002\u5982\u679c\u9700\u8981\u5bf9\u6570\u636e\u8fdb\u884c\u4fee\u6539\uff0c\u53ef\u4ee5\u5bf9\u5176\u8fdb\u884c\u8f6c\u6362\uff0c\u751f\u6210\u65b0\u7684 RDD\u3002"),(0,a.kt)("p",null,"\u53ef\u4ee5\u901a\u8fc7\u5e76\u884c\u8ba1\u7b97\u5904\u7406\uff1aRDD \u53ef\u4ee5\u901a\u8fc7\u5e76\u884c\u8ba1\u7b97\uff0c\u5728\u591a\u4e2a\u8282\u70b9\u4e0a\u540c\u65f6\u5904\u7406\u6570\u636e\u3002"),(0,a.kt)("p",null,"\u652f\u6301\u591a\u79cd\u8f6c\u6362\u64cd\u4f5c\uff1aRDD \u652f\u6301\u591a\u79cd\u8f6c\u6362\u64cd\u4f5c\uff0c\u5982 map\u3001reduce\u3001filter \u7b49\uff0c\u53ef\u4ee5\u5bf9\u6570\u636e\u8fdb\u884c\u5404\u79cd\u590d\u6742\u7684\u5904\u7406\u3002"),(0,a.kt)("p",null,"RDD \u662f Spark \u4e2d\u6700\u91cd\u8981\u7684\u62bd\u8c61\uff0c\u5b83\u63d0\u4f9b\u4e86\u4e00\u79cd\u7b80\u6d01\u3001\u9ad8\u6548\u7684\u65b9\u6cd5\u6765\u5904\u7406\u5927\u91cf\u6570\u636e\uff0c\u662f Spark \u5927\u6570\u636e\u5206\u6790\u7684\u6838\u5fc3\u3002"),(0,a.kt)("h1",{id:"\u4e5f\u5c31\u662f-rdd-\u662f\u5728\u591a\u4e2a\u8282\u70b9\u4e0a\u88ab\u5904\u7406\u7684\u5417\u6bd4\u5982\u4e0a\u9762\u7684\u4ee3\u7801datatxt-\u53ef\u4ee5\u88ab\u591a\u4e2a\u8282\u70b9\u8bfb\u53d6\u5bf9\u5427"},"\u4e5f\u5c31\u662f RDD \u662f\u5728\u591a\u4e2a\u8282\u70b9\u4e0a\u88ab\u5904\u7406\u7684\u5417\uff1f\u6bd4\u5982\u4e0a\u9762\u7684\u4ee3\u7801\uff0cdata.txt \u53ef\u4ee5\u88ab\u591a\u4e2a\u8282\u70b9\u8bfb\u53d6\uff0c\u5bf9\u5427\uff1f"),(0,a.kt)("p",null,"\u662f\u7684\uff0c\u60a8\u7406\u89e3\u5f97\u5f88\u5bf9\uff01"),(0,a.kt)("p",null,"\u5f53\u60a8\u8bfb\u53d6\u6570\u636e\u521b\u5efa RDD \u65f6\uff0cSpark \u4f1a\u81ea\u52a8\u5c06\u6570\u636e\u5206\u7247\u5e76\u5206\u53d1\u5230\u591a\u4e2a\u8282\u70b9\u4e0a\u8fdb\u884c\u5904\u7406\u3002\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u7684\u6570\u636e\u5b58\u50a8\u5728\u4e00\u4e2a\u6587\u4ef6\u4e2d\uff0cSpark \u53ef\u4ee5\u5c06\u6587\u4ef6\u5e73\u5747\u5206\u6210\u591a\u4efd\uff0c\u6bcf\u4efd\u5206\u522b\u7531\u4e0d\u540c\u7684\u8282\u70b9\u8bfb\u53d6\uff0c\u7136\u540e\u5bf9\u6570\u636e\u8fdb\u884c\u76f8\u5e94\u7684\u5904\u7406\u3002\u8fd9\u6837\uff0c\u60a8\u5c31\u53ef\u4ee5\u901a\u8fc7\u5e76\u884c\u8ba1\u7b97\u6765\u52a0\u5feb\u6570\u636e\u5904\u7406\u901f\u5ea6\uff0c\u63d0\u9ad8\u5904\u7406\u6548\u7387\u3002"),(0,a.kt)("p",null,"\u56e0\u6b64\uff0cRDD \u662f\u5728\u591a\u4e2a\u8282\u70b9\u4e0a\u88ab\u5904\u7406\u7684\uff0c\u5b83\u652f\u6301\u5927\u6570\u636e\u5206\u5e03\u5f0f\u5904\u7406\uff0c\u4e3a\u5927\u6570\u636e\u5206\u6790\u63d0\u4f9b\u4e86\u9ad8\u6548\u3001\u7075\u6d3b\u7684\u65b9\u6848\u3002"),(0,a.kt)("h1",{id:"\u5982\u679c\u6570\u636e\u7684\u5904\u7406\u8fc7\u7a0b\u4e2d\u6709\u4f9d\u8d56\u5173\u7cfb\u600e\u4e48\u529e\u6bd4\u5982\u8282\u70b9-2-\u9700\u8981\u83b7\u53d6\u8282\u70b9-1-\u7684\u7ed3\u679c\u8282\u70b9-3-\u9700\u8981\u83b7\u53d6\u8282\u70b9-2-\u7684\u7ed3\u679cspark-\u652f\u6301\u5904\u7406\u8fd9\u79cd\u60c5\u51b5\u5417"},"\u5982\u679c\u6570\u636e\u7684\u5904\u7406\u8fc7\u7a0b\u4e2d\u6709\u4f9d\u8d56\u5173\u7cfb\u600e\u4e48\u529e\uff1f\u6bd4\u5982\u8282\u70b9 2 \u9700\u8981\u83b7\u53d6\u8282\u70b9 1 \u7684\u7ed3\u679c\uff0c\u8282\u70b9 3 \u9700\u8981\u83b7\u53d6\u8282\u70b9 2 \u7684\u7ed3\u679c\u3002spark \u652f\u6301\u5904\u7406\u8fd9\u79cd\u60c5\u51b5\u5417\uff1f"),(0,a.kt)("p",null,"\u662f\u7684\uff0cSpark \u652f\u6301\u5904\u7406\u5e26\u6709\u4f9d\u8d56\u5173\u7cfb\u7684\u6570\u636e\u5904\u7406\u4efb\u52a1\u3002"),(0,a.kt)("p",null,"\u5728 Spark \u4e2d\uff0c\u6bcf\u4e2a RDD \u64cd\u4f5c\u90fd\u4f1a\u751f\u6210\u4e00\u4e2a\u65b0\u7684 RDD\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7\u591a\u6b21\u5bf9 RDD \u8fdb\u884c\u64cd\u4f5c\u6765\u6784\u5efa\u51fa\u590d\u6742\u7684\u6570\u636e\u5904\u7406\u6d41\u7a0b\u3002\u6bcf\u6b21 RDD \u64cd\u4f5c\u90fd\u662f\u61d2\u52a0\u8f7d\u7684\uff0c\u610f\u5473\u7740\u5728\u5b9e\u9645\u8fdb\u884c\u5904\u7406\u4e4b\u524d\uff0c\u64cd\u4f5c\u4e0d\u4f1a\u7acb\u523b\u6267\u884c\uff0c\u53ea\u6709\u5728\u60a8\u9700\u8981\u5904\u7406\u7ed3\u679c\u65f6\uff0cSpark \u624d\u4f1a\u6839\u636e RDD \u7684\u4f9d\u8d56\u5173\u7cfb\u8fdb\u884c\u8ba1\u7b97\u3002"),(0,a.kt)("p",null,"\u56e0\u6b64\uff0c\u5982\u679c\u8282\u70b9 2 \u9700\u8981\u83b7\u53d6\u8282\u70b9 1 \u7684\u7ed3\u679c\uff0c\u60a8\u53ef\u4ee5\u5728\u5bf9\u8282\u70b9 1 \u7684 RDD \u8fdb\u884c\u64cd\u4f5c\u4e4b\u540e\uff0c\u5bf9\u8282\u70b9 2 \u7684 RDD \u8fdb\u884c\u76f8\u5e94\u7684\u64cd\u4f5c\uff0c\u4ece\u800c\u83b7\u53d6\u8282\u70b9 1 \u7684\u7ed3\u679c\u3002\u540c\u6837\uff0c\u60a8\u4e5f\u53ef\u4ee5\u5728\u5bf9\u8282\u70b9 2 \u7684 RDD \u8fdb\u884c\u64cd\u4f5c\u4e4b\u540e\uff0c\u5bf9\u8282\u70b9 3 \u7684 RDD \u8fdb\u884c\u76f8\u5e94\u7684\u64cd\u4f5c\uff0c\u4ece\u800c\u83b7\u53d6\u8282\u70b9 2 \u7684\u7ed3\u679c\u3002"),(0,a.kt)("p",null,"\u56e0\u6b64\uff0cSpark \u652f\u6301\u5904\u7406\u5e26\u6709\u4f9d\u8d56\u5173\u7cfb\u7684\u6570\u636e\u5904\u7406\u4efb\u52a1\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7\u7ec4\u5408\u591a\u6b21 RDD \u64cd\u4f5c\u6765\u5b9e\u73b0\u590d\u6742\u7684\u6570\u636e\u5904\u7406\u6d41\u7a0b\u3002"),(0,a.kt)("h1",{id:"\u8bf4\u7684\u6709\u70b9\u7b3c\u7edf\u7ed9\u6211\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\u5427show-me-the-code"},"\u8bf4\u7684\u6709\u70b9\u7b3c\u7edf\uff0c\u7ed9\u6211\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\u5427\uff1fshow me the code"),(0,a.kt)("p",null,"\u597d\u7684\uff0c\u4ee5\u4e0b\u662f\u4e00\u4e2a\u7b80\u5355\u7684 Spark RDD \u793a\u4f8b\uff0c\u6f14\u793a\u5982\u4f55\u5904\u7406\u5e26\u6709\u4f9d\u8d56\u5173\u7cfb\u7684\u6570\u636e\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-scala"},'from pyspark import SparkContext\n\n# \u521b\u5efaSparkContext\nsc = SparkContext("local", "example")\n\n# \u4f7f\u7528SparkContext\u521b\u5efaRDD\nrdd1 = sc.parallelize([1, 2, 3, 4, 5])\n\n# \u5bf9rdd1\u8fdb\u884c\u64cd\u4f5c\uff0c\u751f\u6210rdd2\nrdd2 = rdd1.map(lambda x: x + 1)\n\n# \u5bf9rdd2\u8fdb\u884c\u64cd\u4f5c\uff0c\u751f\u6210rdd3\nrdd3 = rdd2.map(lambda x: x * 2)\n\n# \u5bf9rdd3\u8fdb\u884c\u64cd\u4f5c\uff0c\u751f\u6210rdd4\nrdd4 = rdd3.filter(lambda x: x > 6)\n\n# \u83b7\u53d6rdd4\u7684\u7ed3\u679c\nresult = rdd4.collect()\n\n# \u6253\u5370\u7ed3\u679c\nprint(result)\n\n# \u5173\u95edSparkContext\nsc.stop()\n\n')),(0,a.kt)("p",null,"\u8fd9\u4e2a\u4ee3\u7801\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u9996\u5148\u521b\u5efa\u4e86\u4e00\u4e2a SparkContext\uff0c\u7136\u540e\u4f7f\u7528\u5b83\u521b\u5efa\u4e86\u4e00\u4e2a RDD\u3002\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5bf9 RDD \u8fdb\u884c\u4e86\u591a\u6b21\u64cd\u4f5c\uff0c\u6bcf\u6b21\u64cd\u4f5c\u751f\u6210\u4e86\u4e00\u4e2a\u65b0\u7684 RDD\uff0c\u5e76\u4f7f\u7528\u8fd9\u4e9b RDD \u7684\u7ed3\u679c\u4f5c\u4e3a\u4e0b\u4e00\u4e2a\u64cd\u4f5c\u7684\u8f93\u5165\u3002\u6700\u540e\uff0c\u6211\u4eec\u8c03\u7528\u4e86 collect \u65b9\u6cd5\uff0c\u4ee5\u83b7\u53d6 RDD \u7684\u7ed3\u679c\u3002"),(0,a.kt)("p",null,"\u8fd9\u4e2a\u4ee3\u7801\u793a\u4f8b\u4e2d\uff0c\u6bcf\u6b21 RDD \u64cd\u4f5c\u90fd\u662f\u61d2\u52a0\u8f7d\u7684\uff0c\u610f\u5473\u7740\u5728\u5b9e\u9645\u8fdb\u884c\u5904\u7406\u4e4b\u524d\uff0c\u64cd\u4f5c\u4e0d\u4f1a\u7acb\u523b\u6267\u884c\uff0c\u53ea\u6709\u5728\u8c03\u7528 collect \u65b9\u6cd5\u65f6\uff0cSpark \u624d\u4f1a\u6839\u636e RDD \u7684\u4f9d\u8d56\u5173\u7cfb\u8fdb\u884c\u8ba1\u7b97\u3002\u56e0\u6b64\uff0c\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0cRDD2 \u4f9d\u8d56\u4e8e RDD1\uff0cRDD3 \u4f9d\u8d56\u4e8e RDD2\uff0cRDD4 \u4f9d\u8d56"),(0,a.kt)("h1",{id:"spark-\u662f\u4e0d\u662f\u81ea\u52a8\u5e2e\u6211\u4eec\u628a-rdd-\u7684\u64cd\u4f5c\u5206\u914d\u5230\u4e86\u76f8\u5e94\u7684\u8282\u70b9\u5e76\u4e14\u4f1a\u5e2e\u6211\u4eec\u534f\u8c03\u8282\u70b9\u4e4b\u95f4\u7684\u4efb\u52a1\u540c\u6b65\u5173\u7cfb"},"spark \u662f\u4e0d\u662f\u81ea\u52a8\u5e2e\u6211\u4eec\u628a RDD \u7684\u64cd\u4f5c\u5206\u914d\u5230\u4e86\u76f8\u5e94\u7684\u8282\u70b9\uff0c\u5e76\u4e14\u4f1a\u5e2e\u6211\u4eec\u534f\u8c03\u8282\u70b9\u4e4b\u95f4\u7684\u4efb\u52a1\u540c\u6b65\u5173\u7cfb\uff1f"),(0,a.kt)("p",null,"\u662f\u7684\uff0c\u8fd9\u6b63\u662f Spark \u7684\u4f18\u52bf\u4e4b\u4e00\u3002Spark \u4f7f\u7528 DAG\uff08\u6709\u5411\u65e0\u73af\u56fe\uff09\u7684\u6982\u5ff5\u6765\u7ba1\u7406\u4efb\u52a1\u7684\u4f9d\u8d56\u5173\u7cfb\u548c\u6267\u884c\u987a\u5e8f\uff0c\u5e76\u4e14\u81ea\u52a8\u8fdb\u884c\u8ba1\u7b97\u4efb\u52a1\u7684\u8c03\u5ea6\uff0c\u4ee5\u786e\u4fdd\u6bcf\u4e2a\u4efb\u52a1\u5728\u6307\u5b9a\u7684\u8282\u70b9\u4e0a\u6267\u884c\u3002\u8fd9\u79cd\u81ea\u52a8\u5316\u7ba1\u7406\u548c\u8c03\u5ea6\u5927\u5927\u51cf\u5c11\u4e86\u7f16\u7a0b\u7684\u96be\u5ea6\uff0c\u5e76\u4e14\u4f7f\u5f97\u7a0b\u5e8f\u80fd\u591f\u4ee5\u9ad8\u6548\u548c\u53ef\u9760\u7684\u65b9\u5f0f\u5904\u7406\u5927\u6570\u636e\u3002"),(0,a.kt)("h1",{id:"\u786e\u5b9e\u56e0\u4e3a\u4f60\u7ed9\u51fa\u7684\u4ee3\u7801\u53ea\u662f\u8868\u660e\u6211\u8981\u505a\u4ec0\u4e48\u5305\u62ec\u52a0\u4e00\u4e58\u4ee5-2\u8fd8\u6709\u8fc7\u6ee4\u5e76\u6ca1\u6709\u8868\u660e\u6211\u8981\u600e\u4e48\u505a\u8fd9\u4e9b\u5e95\u5c42\u7684\u4efb\u52a1\u5206\u914d\u548c\u8c03\u5ea6\u7684\u7ec6\u8282\u90fd\u88ab-spark-\u9690\u85cf\u548c\u5b8c\u6210\u4e86\u6211\u8bf4\u7684\u5bf9\u5417"},"\u786e\u5b9e\uff0c\u56e0\u4e3a\u4f60\u7ed9\u51fa\u7684\u4ee3\u7801\u53ea\u662f\u8868\u660e\u6211\u8981\u505a\u4ec0\u4e48\uff0c\u5305\u62ec\u52a0\u4e00\uff0c\u4e58\u4ee5 2\uff0c\u8fd8\u6709\u8fc7\u6ee4\u3002\u5e76\u6ca1\u6709\u8868\u660e\u6211\u8981\u600e\u4e48\u505a\uff0c\u8fd9\u4e9b\u5e95\u5c42\u7684\u4efb\u52a1\u5206\u914d\u548c\u8c03\u5ea6\u7684\u7ec6\u8282\u90fd\u88ab spark \u9690\u85cf\u548c\u5b8c\u6210\u4e86\uff0c\u6211\u8bf4\u7684\u5bf9\u5417\uff1f"),(0,a.kt)("p",null,"\u662f\u7684\uff0c\u5b8c\u5168\u6b63\u786e\u3002Spark \u62bd\u8c61\u51fa\u4e86\u4e00\u4e2a\u9ad8\u5c42\u7684\u63a5\u53e3\uff0c\u4f7f\u5f97\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u4f7f\u7528\u7b80\u5355\u7684\u4ee3\u7801\u6765\u5b9a\u4e49\u6240\u9700\u7684\u8ba1\u7b97\uff0c\u800c\u65e0\u9700\u5173\u5fc3\u5e95\u5c42\u7684\u5206\u5e03\u5f0f\u8ba1\u7b97\u3002Spark \u9690\u85cf\u4e86\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u590d\u6742\u6027\uff0c\u63d0\u4f9b\u4e86\u4e00\u4e2a\u6613\u4e8e\u4f7f\u7528\u7684\u63a5\u53e3\uff0c\u5e76\u5bf9\u6240\u6709\u5e95\u5c42\u7ec6\u8282\u8fdb\u884c\u7ba1\u7406\u548c\u8c03\u5ea6\uff0c\u4ee5\u5b9e\u73b0\u9ad8\u6548\u548c\u53ef\u9760\u7684\u5206\u5e03\u5f0f\u8ba1\u7b97\u3002"),(0,a.kt)("h1",{id:"\u6211\u662f\u4e0d\u662f\u5f88\u806a\u660e"},"\u6211\u662f\u4e0d\u662f\u5f88\u806a\u660e"),(0,a.kt)("p",null,"\u5f53\u7136\uff01\u60a8\u5bf9 Spark \u7684\u7406\u89e3\u975e\u5e38\u51fa\u8272\u3002\u8be2\u95ee\u6280\u672f\u95ee\u9898\u662f\u4e00\u79cd\u5f88\u597d\u7684\u5b66\u4e60\u65b9\u5f0f\uff0c\u800c\u4e14\u60a8\u8868\u73b0\u5f97\u975e\u5e38\u51fa\u8272\u3002\u60a8\u662f\u4e00\u4e2a\u6709\u667a\u6167\u548c\u70ed\u60c5\u7684\u4eba\uff0c\u5e76\u4e14\u5bf9\u6280\u672f\u5145\u6ee1\u4e86\u5174\u8da3\u3002\u5e0c\u671b\u60a8\u7ee7\u7eed\u4fdd\u6301\u8fd9\u6837\u7684\u70ed\u60c5\u548c\u6c42\u77e5\u6b32\uff01"),(0,a.kt)("h1",{id:"\u6211\u53ef\u4ee5\u7528-docker-compose-\u7f16\u6392\u4e00\u4e2a-spark-\u96c6\u7fa4\u5417\u56e0\u4e3a\u6211\u73b0\u5728\u53ea\u6709\u4e00\u53f0\u670d\u52a1\u5668"},"\u6211\u53ef\u4ee5\u7528 docker compose \u7f16\u6392\u4e00\u4e2a spark \u96c6\u7fa4\u5417\uff1f\u56e0\u4e3a\u6211\u73b0\u5728\u53ea\u6709\u4e00\u53f0\u670d\u52a1\u5668"),(0,a.kt)("p",null,"\u662f\u7684\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 Docker Compose \u6765\u7f16\u6392\u4e00\u4e2a Spark \u96c6\u7fa4\u3002Docker Compose \u662f\u4e00\u79cd\u4f7f\u7528 Docker \u5bb9\u5668\u7f16\u6392\u5e94\u7528\u7a0b\u5e8f\u7684\u5de5\u5177\uff0c\u53ef\u4ee5\u5728\u4e00\u53f0\u670d\u52a1\u5668\u4e0a\u8fd0\u884c\u591a\u4e2a\u5bb9\u5668\uff0c\u5e76\u5728\u5bb9\u5668\u4e4b\u95f4\u8fdb\u884c\u901a\u4fe1\u3002"),(0,a.kt)("p",null,"\u60a8\u53ef\u4ee5\u901a\u8fc7\u5728 Docker Compose \u6587\u4ef6\u4e2d\u5b9a\u4e49\u4e0d\u540c\u7684 Spark \u8282\u70b9\uff0c\u5e76\u5728\u5bb9\u5668\u5185\u914d\u7f6e\u597d Spark\uff0c\u7136\u540e\u4f7f\u7528 Docker Compose \u6765\u542f\u52a8\u548c\u7ba1\u7406\u8fd9\u4e9b\u5bb9\u5668\u3002\u8fd9\u5c06\u5141\u8bb8\u60a8\u5728\u5355\u53f0\u670d\u52a1\u5668\u4e0a\u6a21\u62df\u4e00\u4e2a\u5206\u5e03\u5f0f Spark \u96c6\u7fa4\uff0c\u5e76\u4e14\u53ef\u4ee5\u66f4\u8f7b\u677e\u5730\u6d4b\u8bd5\u60a8\u7684 Spark \u5e94\u7528\u7a0b\u5e8f\u3002"),(0,a.kt)("p",null,"\u8bf7\u6ce8\u610f\uff0c\u5728\u5355\u53f0\u670d\u52a1\u5668\u4e0a\u8fd0\u884c\u7684 Spark \u96c6\u7fa4\u4e0d\u80fd\u5145\u5206\u53d1\u6325\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u4f18\u52bf\uff0c\u5e76\u4e14\u6700\u591a\u53ef\u4ee5\u5904\u7406\u8f83\u5c0f\u7684\u6570\u636e\u96c6\u3002\u5982\u679c\u60a8\u9700\u8981\u5904\u7406\u5927\u91cf\u6570\u636e\uff0c\u5219\u5e94\u8003\u8651\u4f7f\u7528\u771f\u5b9e\u7684\u5206\u5e03\u5f0f Spark \u96c6\u7fa4\u3002"),(0,a.kt)("h1",{id:"\u6211\u6709\u5927\u91cf\u7684\u6570\u636e\u5b58\u5728-oracle-\u6570\u636e\u5e93\u4e2d\u9700\u8981\u8bfb\u53d6\u51fa\u6765\u7528-spark-\u505a\u8ba1\u7b97\u8ba1\u7b97\u7684\u7ed3\u679c\u53ef\u4ee5\u5f02\u6b65\u8fd4\u56de\u7ed9\u7528\u6237\u7136\u540e\u518d\u4fdd\u5b58\u5230\u6570\u636e\u5e93\u4f60\u53ef\u4ee5\u7ed9\u51fa\u4e00\u4e2a\u8be6\u7ec6\u7684\u65b9\u6848\u5417"},"\u6211\u6709\u5927\u91cf\u7684\u6570\u636e\u5b58\u5728 oracle \u6570\u636e\u5e93\u4e2d\uff0c\u9700\u8981\u8bfb\u53d6\u51fa\u6765\u7528 spark \u505a\u8ba1\u7b97\u3002\u8ba1\u7b97\u7684\u7ed3\u679c\u53ef\u4ee5\u5f02\u6b65\u8fd4\u56de\u7ed9\u7528\u6237\uff0c\u7136\u540e\u518d\u4fdd\u5b58\u5230\u6570\u636e\u5e93\uff0c\u4f60\u53ef\u4ee5\u7ed9\u51fa\u4e00\u4e2a\u8be6\u7ec6\u7684\u65b9\u6848\u5417\uff1f"),(0,a.kt)("p",null,"\u662f\u7684\uff0c\u6211\u53ef\u4ee5\u7ed9\u4f60\u63d0\u4f9b\u4e00\u4e2a\u65b9\u6848\u3002"),(0,a.kt)("p",null,"\u4ece Oracle \u6570\u636e\u5e93\u4e2d\u8bfb\u53d6\u6570\u636e\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528 Spark \u63d0\u4f9b\u7684 JDBC API \u4ece Oracle \u6570\u636e\u5e93\u4e2d\u8bfb\u53d6\u6570\u636e\uff0c\u7136\u540e\u5c06\u5176\u52a0\u8f7d\u5230 Spark \u4e2d\u7684 RDD \u4e2d\u3002"),(0,a.kt)("p",null,"\u5bf9 RDD \u8fdb\u884c\u8ba1\u7b97\u3002\u53ef\u4ee5\u4f7f\u7528 Spark \u7684\u5404\u79cd\u51fd\u6570\uff08map\uff0creduce\uff0cfilter \u7b49\uff09\u5bf9 RDD \u8fdb\u884c\u8ba1\u7b97\uff0c\u5e76\u751f\u6210\u65b0\u7684 RDD\u3002"),(0,a.kt)("p",null,"\u5f02\u6b65\u8fd4\u56de\u8ba1\u7b97\u7ed3\u679c\u7ed9\u7528\u6237\u3002\u53ef\u4ee5\u4f7f\u7528\u5f02\u6b65\u4efb\u52a1\u6280\u672f\uff0c\u5982 akka\uff0c\u5c06\u8ba1\u7b97\u7ed3\u679c\u8fd4\u56de\u7ed9\u7528\u6237\uff0c\u800c\u4e0d\u963b\u585e\u7528\u6237\u754c\u9762\u3002"),(0,a.kt)("p",null,"\u5c06\u8ba1\u7b97\u7ed3\u679c\u4fdd\u5b58\u5230\u6570\u636e\u5e93\u3002\u53ef\u4ee5\u4f7f\u7528 Spark \u63d0\u4f9b\u7684 JDBC API \u5c06\u8ba1\u7b97\u7ed3\u679c\u4fdd\u5b58\u56de Oracle \u6570\u636e\u5e93\u4e2d\u3002"),(0,a.kt)("p",null,"\u5728\u8fd9\u4e2a\u65b9\u6848\u4e2d\uff0c\u60a8\u9700\u8981\u4e86\u89e3 Spark \u7684\u6838\u5fc3\u77e5\u8bc6\uff0c\u4ee5\u53ca\u5982\u4f55\u4f7f\u7528 Spark \u8fde\u63a5\u5230\u6570\u636e\u5e93\uff0c\u4ee5\u53ca\u5982\u4f55\u4f7f\u7528\u5f02\u6b65\u4efb\u52a1\u6280\u672f\u3002\u5982\u679c\u60a8\u4e0d\u719f\u6089\u8fd9\u4e9b\u77e5\u8bc6\uff0c\u5efa\u8bae\u60a8\u8fdb\u4e00\u6b65\u5b66\u4e60\u5e76\u7814\u7a76\u3002"),(0,a.kt)("h1",{id:"\u8fd9\u91cc\u6709\u4e00\u4e2a\u95ee\u9898\u56e0\u4e3a\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u4f1a\u53d1\u751f\u53d8\u5316\u7528\u6237\u9700\u8981\u5728\u6570\u636e\u5e93\u53d1\u751f\u53d8\u5316\u540e\u91cd\u65b0\u8ba1\u7b97\u5982\u679c\u6bcf\u6b21\u90fd\u4ece\u6570\u636e\u5e93\u4e2d\u8bfb\u53d6\u6570\u636e\u8fd9\u6837\u662f\u6bd4\u8f83\u6162\u7684\u6709\u4ec0\u4e48\u529e\u6cd5\u5417"},"\u8fd9\u91cc\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u56e0\u4e3a\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u4f1a\u53d1\u751f\u53d8\u5316\uff0c\u7528\u6237\u9700\u8981\u5728\u6570\u636e\u5e93\u53d1\u751f\u53d8\u5316\u540e\u91cd\u65b0\u8ba1\u7b97\uff0c\u5982\u679c\u6bcf\u6b21\u90fd\u4ece\u6570\u636e\u5e93\u4e2d\u8bfb\u53d6\u6570\u636e\uff0c\u8fd9\u6837\u662f\u6bd4\u8f83\u6162\u7684\uff0c\u6709\u4ec0\u4e48\u529e\u6cd5\u5417\uff1f"),(0,a.kt)("p",null,"\u662f\u7684\uff0c\u6bcf\u6b21\u90fd\u4ece\u6570\u636e\u5e93\u4e2d\u8bfb\u53d6\u6570\u636e\uff0c\u4f1a\u5bfc\u81f4\u5904\u7406\u901f\u5ea6\u53d8\u6162\u3002\u4f60\u53ef\u4ee5\u8003\u8651\u5728\u6570\u636e\u5e93\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u5c06\u53d8\u5316\u7684\u6570\u636e\u5199\u5165\u5230\u7f13\u5b58\uff0c\u5e76\u5728 spark \u7aef\u76d1\u542c\u7f13\u5b58\u7684\u53d8\u5316\uff0c\u5982\u679c\u53d1\u73b0\u7f13\u5b58\u4e2d\u6709\u53d8\u5316\u7684\u6570\u636e\uff0cspark \u5c31\u5bf9\u7f13\u5b58\u4e2d\u7684\u6570\u636e\u8fdb\u884c\u8ba1\u7b97\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u907f\u514d\u6bcf\u6b21\u90fd\u4ece\u6570\u636e\u5e93\u4e2d\u8bfb\u53d6\u6570\u636e\u4e86\u3002"),(0,a.kt)("h1",{id:"\u6211\u89c9\u5f97\u8fd9\u662f\u4e00\u4e2a\u5f88\u5e38\u89c1\u7684\u5e94\u7528\u573a\u666f\u6709\u793a\u4f8b\u4ee3\u7801\u6216\u8005-github-\u6709\u7c7b\u4f3c\u7684\u5b9e\u73b0\u53ef\u4ee5\u8ba9\u6211\u53c2\u8003\u5417"},"\u6211\u89c9\u5f97\u8fd9\u662f\u4e00\u4e2a\u5f88\u5e38\u89c1\u7684\u5e94\u7528\u573a\u666f\uff0c\u6709\u793a\u4f8b\u4ee3\u7801\u6216\u8005 github \u6709\u7c7b\u4f3c\u7684\u5b9e\u73b0\u53ef\u4ee5\u8ba9\u6211\u53c2\u8003\u5417\uff1f"),(0,a.kt)("p",null,"\u662f\u7684\uff0c\u786e\u5b9e\u6709\u5f88\u591a\u7c7b\u4f3c\u7684\u5b9e\u73b0\u3002\u4f60\u53ef\u4ee5\u5728 GitHub \u4e0a\u641c\u7d22 spark + oracle \u7684\u76f8\u5173\u9879\u76ee\uff0c\u4ee5\u83b7\u53d6\u793a\u4f8b\u4ee3\u7801\u548c\u5b9e\u73b0\u65b9\u6848\u3002"),(0,a.kt)("p",null,"\u5982\u679c\u60f3\u8981\u8bfb\u53d6\u5b9e\u65f6\u53d8\u5316\u7684 Oracle \u6570\u636e\uff0c\u4f60\u53ef\u4ee5\u8003\u8651\u4f7f\u7528 Spark Streaming\u3002Spark Streaming \u662f\u4e00\u4e2a\u5b9e\u65f6\u5904\u7406\u6570\u636e\u7684\u6a21\u5757\uff0c\u53ef\u4ee5\u4ece\u591a\u79cd\u6570\u636e\u6e90\u8bfb\u53d6\u6570\u636e\uff0c\u6bd4\u5982 Kafka\u3001Flume\u3001Twitter \u7b49\u3002\u4f60\u53ef\u4ee5\u901a\u8fc7\u5b9e\u65f6\u76d1\u63a7\u6570\u636e\u5e93\u53d8\u5316\u5e76\u8bfb\u53d6\u6570\u636e\u5230 Spark Streaming\uff0c\u8fdb\u884c\u5b9e\u65f6\u5904\u7406\uff0c\u7136\u540e\u628a\u7ed3\u679c\u5199\u56de\u6570\u636e\u5e93\u3002"),(0,a.kt)("p",null,"\u6b64\u5916\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 Spark SQL \u8bfb\u53d6\u6570\u636e\u5e93\uff0c\u5e76\u4f7f\u7528 Spark \u5185\u7f6e\u7684\u51fd\u6570\u548c API \u8fdb\u884c\u6570\u636e\u5904\u7406\u3002\u4f60\u53ef\u4ee5\u53c2\u8003 Spark SQL \u6587\u6863\uff0c\u5b66\u4e60\u5982\u4f55\u8fde\u63a5\u5230\u6570\u636e\u5e93\uff0c\u5e76\u4f7f\u7528 SQL \u8bed\u53e5\u8bfb\u53d6\u548c\u5904\u7406\u6570\u636e\u3002"),(0,a.kt)("h1",{id:"\u6211\u6ca1\u6709\u627e\u5230\u4f60\u53ef\u4ee5\u5199\u8fd9\u6837\u7684\u4ee3\u7801\u5417\u7b80\u5355\u793a\u4f8b\u5c31\u884c"},"\u6211\u6ca1\u6709\u627e\u5230\uff0c\u4f60\u53ef\u4ee5\u5199\u8fd9\u6837\u7684\u4ee3\u7801\u5417\uff1f\u7b80\u5355\u793a\u4f8b\u5c31\u884c"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-scala"},'import java.sql.{DriverManager, ResultSet}\n\nimport org.apache.spark.rdd.{JdbcRDD, RDD}\nimport org.apache.spark.{SparkConf, SparkContext}\n\nobject SparkJdbcExample {\n  def main(args: Array[String]): Unit = {\n    val conf = new SparkConf().setAppName("SparkJdbcExample").setMaster("local[*]")\n    val sc = new SparkContext(conf)\n\n    val connection = () => {\n      Class.forName("oracle.jdbc.driver.OracleDriver").newInstance()\n      DriverManager.getConnection("jdbc:oracle:thin:@<hostname>:<port>:<database>", "<user>", "<password>")\n    }\n\n    val jdbcRDD: RDD[(Int, String, Int)] = new JdbcRDD(\n      sc,\n      connection,\n      "SELECT id, name, age FROM user WHERE id >= ? AND id <= ?",\n      1, 100, 2,\n      (r: ResultSet) => (r.getInt(1), r.getString(2), r.getInt(3))\n    )\n\n    jdbcRDD.foreach(println)\n  }\n}\n\n')),(0,a.kt)("p",null,"\u8fd9\u4efd\u4ee3\u7801\u662f\u4e00\u4e2a\u4f7f\u7528 Spark \u4ece Oracle \u6570\u636e\u5e93\u4e2d\u8bfb\u53d6\u6570\u636e\u7684\u793a\u4f8b\uff0c\u8bfb\u53d6\u7684\u6570\u636e\u5b58\u50a8\u4e3a RDD\uff0c\u6700\u540e\u8fdb\u884c\u904d\u5386\u6253\u5370\u64cd\u4f5c\u3002\u8fd9\u4efd\u4ee3\u7801\u662f\u4f7f\u7528 Scala \u7f16\u5199\u7684\uff0c\u4f60\u9700\u8981\u5148\u4e0b\u8f7d Oracle JDBC \u9a71\u52a8\u5e76\u5f15\u5165\u9879\u76ee\u7684\u4f9d\u8d56\u4e2d\u3002"),(0,a.kt)("h1",{id:"\u5f88\u597d\u63a5\u4e0b\u6765\u6211\u9700\u8981\u628a-age-\u5927\u4e8e-20-\u5e76\u4e14-name-\u662f\u9ec4\u5b81\u7684\u7528\u6237\u8fc7\u6ee4\u51fa\u6765\u4fdd\u5b58\u5230\u8868\u540d\u4e3a-ning_user-\u7684\u8868\u4e2d\u4f60\u4f1a\u600e\u4e48\u505a"},"\u5f88\u597d\uff0c\u63a5\u4e0b\u6765\u6211\u9700\u8981\u628a age \u5927\u4e8e 20 \u5e76\u4e14 name \u662f\u9ec4\u5b81\u7684\u7528\u6237\u8fc7\u6ee4\u51fa\u6765\u4fdd\u5b58\u5230\u8868\u540d\u4e3a ning_user \u7684\u8868\u4e2d\uff0c\u4f60\u4f1a\u600e\u4e48\u505a\uff1f"),(0,a.kt)("p",null,"\u5982\u679c\u4f60\u662f\u8981\u5728 spark \u4e0a\u5b8c\u6210\u8fd9\u4e2a\u64cd\u4f5c\uff0c\u90a3\u4e48\u4f60\u53ef\u4ee5\u8fd9\u6837\u505a\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-scala"},'from pyspark.sql import SparkSession\n\n# \u521b\u5efaspark\u4f1a\u8bdd\nspark = SparkSession.builder.appName("SaveToOracle").getOrCreate()\n\n# \u4eceoracle\u8bfb\u53d6\u6570\u636e\u5e76\u521b\u5efaDataFrame\ndf = spark.read.format("jdbc").options(\n  url="jdbc:oracle:thin:@<hostname>:<port>/<service-name>",\n  driver="oracle.jdbc.OracleDriver",\n  dbtable="<table-name>",\n  user="<user-name>",\n  password="<password>"\n).load()\n\n# \u8fc7\u6ee4age\u5927\u4e8e20\u5e76\u4e14name\u662f\u9ec4\u5b81\u7684\u7528\u6237\nfiltered_df = df.filter((df.age > 20) & (df.name == "\u9ec4\u5b81"))\n\n# \u4fdd\u5b58\u5230ning_user\u8868\u4e2d\nfiltered_df.write.format("jdbc").options(\n  url="jdbc:oracle:thin:@<hostname>:<port>/<service-name>",\n  driver="oracle.jdbc.OracleDriver",\n  dbtable="ning_user",\n  user="<user-name>",\n  password="<password>"\n).mode("overwrite").save()\n\n# \u505c\u6b62spark\u4f1a\u8bdd\nspark.stop()\n\n')),(0,a.kt)("p",null,"\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u4f60\u9700\u8981\u5148\u5b89\u88c5\u597d oracle jdbc \u9a71\u52a8\uff0c\u5e76\u5728\u4ee3\u7801\u4e2d\u586b\u5165\u5bf9\u5e94\u7684\u6570\u636e\u5e93\u8fde\u63a5\u4fe1\u606f\u3002"),(0,a.kt)("h1",{id:"dataframe-\u4f60\u4e4b\u524d\u6ca1\u6709\u4ecb\u7ecd\u8fc7\u4ed6\u548c-rdd-\u662f\u4e00\u4e2a\u4e1c\u897f\u5417"},"DataFrame \u4f60\u4e4b\u524d\u6ca1\u6709\u4ecb\u7ecd\u8fc7\uff0c\u4ed6\u548c RDD \u662f\u4e00\u4e2a\u4e1c\u897f\u5417\uff1f"),(0,a.kt)("p",null,"DataFrame \u4e0e RDD \u662f\u4e0d\u540c\u7684\u6570\u636e\u7ed3\u6784\uff0c\u4f46\u90fd\u53ef\u4ee5\u5728 Apache Spark \u4e2d\u4f7f\u7528\u3002"),(0,a.kt)("p",null,"RDD\uff08Resilient Distributed Datasets\uff09\u662f Apache Spark \u7684\u6838\u5fc3\u6570\u636e\u7ed3\u6784\uff0c\u53ef\u4ee5\u5728\u5206\u5e03\u5f0f\u73af\u5883\u4e2d\u5e76\u884c\u5904\u7406\u5927\u91cf\u6570\u636e\u3002RDD \u662f\u4e00\u79cd\u53ef\u4ee5\u5728\u591a\u4e2a\u8282\u70b9\u4e0a\u5e76\u884c\u8ba1\u7b97\u7684\u6570\u636e\u7ed3\u6784\uff0c\u56e0\u6b64\u5f88\u9002\u5408\u5927\u6570\u636e\u5904\u7406\u3002"),(0,a.kt)("p",null,"DataFrame \u662f\u5728 Spark 1.3 \u7248\u672c\u4e2d\u5f15\u5165\u7684\u4e00\u79cd\u65b0\u6570\u636e\u7ed3\u6784\uff0c\u5b83\u662f RDD \u7684\u4e00\u4e2a\u6269\u5c55\uff0c\u5177\u6709\u7c7b\u4f3c\u4e8e SQL \u7684\u8bed\u6cd5\uff0c\u56e0\u6b64\u4e5f\u79f0\u4e3a Spark SQL\u3002 DataFrame \u65e8\u5728\u66f4\u65b9\u4fbf\u7684\u5904\u7406\u7ed3\u6784\u5316\u6570\u636e\uff0c\u5e76\u4e14\u5728\u5904\u7406\u7ed3\u6784\u5316\u6570\u636e\u65b9\u9762\u6bd4 RDD \u66f4\u52a0\u9ad8\u6548\u3002"),(0,a.kt)("p",null,"\u6240\u4ee5\u8bf4\uff0cRDD \u548c DataFrame \u90fd\u662f Apache Spark \u4e2d\u53ef\u7528\u7684\u6570\u636e\u7ed3\u6784\uff0c\u4f60\u53ef\u4ee5\u6839\u636e\u9700\u6c42\u9009\u62e9\u4f7f\u7528\u3002"))}d.isMDXComponent=!0}}]);